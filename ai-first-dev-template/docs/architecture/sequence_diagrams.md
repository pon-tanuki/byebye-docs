# シーケンス図

## ユースケース別シーケンス

### UC1: AIエージェントによるコード生成

```
┌────────┐     ┌─────────┐     ┌──────────┐     ┌────────┐     ┌────────┐
│  User  │     │  System │     │ AI Agent │     │  Git   │     │  CI/CD │
└───┬────┘     └────┬────┘     └────┬─────┘     └───┬────┘     └───┬────┘
    │               │               │               │               │
    │  タスク作成    │               │               │               │
    │──────────────>│               │               │               │
    │               │               │               │               │
    │               │  タスク割当    │               │               │
    │               │──────────────>│               │               │
    │               │               │               │               │
    │               │               │  コード取得    │               │
    │               │               │──────────────>│               │
    │               │               │               │               │
    │               │               │  コード返却    │               │
    │               │               │<──────────────│               │
    │               │               │               │               │
    │               │               │ [コード生成]   │               │
    │               │               │───────┐       │               │
    │               │               │       │       │               │
    │               │               │<──────┘       │               │
    │               │               │               │               │
    │               │               │  コミット     │               │
    │               │               │──────────────>│               │
    │               │               │               │               │
    │               │               │               │  ビルド実行   │
    │               │               │               │──────────────>│
    │               │               │               │               │
    │               │               │               │  結果返却     │
    │               │               │               │<──────────────│
    │               │               │               │               │
    │               │  レビュー依頼  │               │               │
    │<──────────────────────────────│               │               │
    │               │               │               │               │
    │  承認/却下    │               │               │               │
    │──────────────>│               │               │               │
    │               │               │               │               │
```

### UC2: バグ修正フロー

```
┌────────┐     ┌─────────┐     ┌──────────┐     ┌────────┐
│ Monitor│     │  System │     │ AI Agent │     │  Human │
└───┬────┘     └────┬────┘     └────┬─────┘     └───┬────┘
    │               │               │               │
    │  エラー検出    │               │               │
    │──────────────>│               │               │
    │               │               │               │
    │               │  分析依頼      │               │
    │               │──────────────>│               │
    │               │               │               │
    │               │               │ [原因特定]     │
    │               │               │───────┐       │
    │               │               │       │       │
    │               │               │<──────┘       │
    │               │               │               │
    │               │  修正案提示    │               │
    │               │<──────────────│               │
    │               │               │               │
    │               │               │  確認依頼      │
    │               │               │──────────────>│
    │               │               │               │
    │               │               │  承認         │
    │               │               │<──────────────│
    │               │               │               │
    │               │               │ [修正適用]     │
    │               │               │───────┐       │
    │               │               │       │       │
    │               │               │<──────┘       │
    │               │               │               │
    │               │  完了通知      │               │
    │               │<──────────────│               │
    │               │               │               │
```

### UC3: ドキュメント自動生成

```
┌────────┐     ┌─────────┐     ┌──────────┐     ┌────────┐
│  User  │     │  System │     │ AI Agent │     │  Docs  │
└───┬────┘     └────┬────┘     └────┬─────┘     └───┬────┘
    │               │               │               │
    │  ドキュメント  │               │               │
    │  生成依頼      │               │               │
    │──────────────>│               │               │
    │               │               │               │
    │               │  コード解析    │               │
    │               │──────────────>│               │
    │               │               │               │
    │               │               │ [構造解析]     │
    │               │               │───────┐       │
    │               │               │       │       │
    │               │               │<──────┘       │
    │               │               │               │
    │               │               │ [文書生成]     │
    │               │               │───────┐       │
    │               │               │       │       │
    │               │               │<──────┘       │
    │               │               │               │
    │               │               │  保存         │
    │               │               │──────────────>│
    │               │               │               │
    │  プレビュー    │               │               │
    │<──────────────────────────────│               │
    │               │               │               │
    │  承認/修正指示 │               │               │
    │──────────────>│               │               │
    │               │               │               │
```

## AIエージェントと人間の連携点

### 承認が必要なポイント

| シーケンス | 連携ポイント | 判断基準 |
|-----------|-------------|---------|
| コード生成 | マージ前レビュー | セキュリティ影響、破壊的変更 |
| バグ修正 | 修正案承認 | 本番影響度、ロールバック可否 |
| ドキュメント | 公開前確認 | 機密情報、正確性 |
| デプロイ | 本番デプロイ承認 | 常に人間承認必須 |

### 自動実行可能なポイント

| シーケンス | 自動化ポイント | 条件 |
|-----------|---------------|------|
| コード生成 | テスト実行 | 全テストパス |
| バグ修正 | 開発環境デプロイ | CI成功 |
| ドキュメント | 下書き保存 | 常時 |

---

_最終更新日: YYYY-MM-DD_
_更新者: [担当者/AIエージェント名]_
