# 依存関係管理

## 概要

本ドキュメントはプロジェクトで使用するライブラリとバージョン管理方針を定義する。

---

## 使用ライブラリ

### ランタイム依存

#### フロントエンド

| ライブラリ | バージョン | 用途 | ライセンス |
|-----------|-----------|------|-----------|
| React | ^18.0.0 | UIフレームワーク | MIT |
| TypeScript | ^5.0.0 | 型システム | Apache-2.0 |
| React Router | ^6.0.0 | ルーティング | MIT |
| Axios | ^1.0.0 | HTTPクライアント | MIT |
| Zustand | ^4.0.0 | 状態管理 | MIT |

#### バックエンド

| ライブラリ | バージョン | 用途 | ライセンス |
|-----------|-----------|------|-----------|
| Node.js | ^20.0.0 | ランタイム | MIT |
| Express | ^4.18.0 | Webフレームワーク | MIT |
| Prisma | ^5.0.0 | ORM | Apache-2.0 |
| Zod | ^3.0.0 | バリデーション | MIT |
| Jose | ^5.0.0 | JWT処理 | MIT |

#### AIエージェント

| ライブラリ | バージョン | 用途 | ライセンス |
|-----------|-----------|------|-----------|
| OpenAI SDK | ^4.0.0 | LLM連携 | MIT |
| LangChain | ^0.1.0 | エージェントフレームワーク | MIT |
| Pinecone | ^2.0.0 | ベクトルDB | Proprietary |

### 開発依存

#### テスト

| ライブラリ | バージョン | 用途 |
|-----------|-----------|------|
| Jest | ^29.0.0 | テストフレームワーク |
| Testing Library | ^14.0.0 | UIテスト |
| Playwright | ^1.40.0 | E2Eテスト |
| MSW | ^2.0.0 | APIモック |

#### コード品質

| ライブラリ | バージョン | 用途 |
|-----------|-----------|------|
| ESLint | ^8.0.0 | リンター |
| Prettier | ^3.0.0 | フォーマッター |
| Husky | ^9.0.0 | Gitフック |
| lint-staged | ^15.0.0 | ステージングリント |

#### ビルド

| ライブラリ | バージョン | 用途 |
|-----------|-----------|------|
| Vite | ^5.0.0 | ビルドツール |
| esbuild | ^0.19.0 | バンドラー |
| Docker | ^24.0.0 | コンテナ |

---

## バージョン管理方針

### バージョニング規則

| 記号 | 意味 | 例 |
|------|------|-----|
| `^` | マイナー・パッチ更新許可 | `^1.2.3` → `1.x.x` |
| `~` | パッチ更新のみ許可 | `~1.2.3` → `1.2.x` |
| 固定 | バージョン固定 | `1.2.3` |

### 更新方針

| 種別 | 方針 | 頻度 |
|------|------|------|
| セキュリティ | 即時更新 | 随時 |
| パッチ | 自動更新可 | 週次 |
| マイナー | レビュー後更新 | 月次 |
| メジャー | 計画的更新 | 四半期 |

### 更新プロセス

```
1. 依存関係スキャン
   ├── npm audit
   ├── npm outdated
   └── Dependabot alerts

2. 更新評価
   ├── 変更履歴確認
   ├── 互換性確認
   └── テスト実行

3. 更新実行
   ├── 開発環境で更新
   ├── テスト実行
   └── PRレビュー

4. デプロイ
   ├── ステージングデプロイ
   ├── 検証
   └── 本番デプロイ
```

---

## ライセンス管理

### 許可ライセンス

| ライセンス | 許可 | 条件 |
|-----------|------|------|
| MIT | 許可 | なし |
| Apache-2.0 | 許可 | なし |
| BSD-2-Clause | 許可 | なし |
| BSD-3-Clause | 許可 | なし |
| ISC | 許可 | なし |

### 要確認ライセンス

| ライセンス | 対応 |
|-----------|------|
| GPL | 法務確認必須 |
| LGPL | 使用方法確認 |
| AGPL | 原則禁止 |
| Proprietary | 個別契約確認 |

### ライセンスチェック

```bash
# ライセンスチェックコマンド
npx license-checker --summary
npx license-checker --production --csv > licenses.csv
```

---

## セキュリティ管理

### 脆弱性スキャン

| ツール | 頻度 | 対象 |
|--------|------|------|
| npm audit | コミット毎 | npm依存関係 |
| Snyk | デイリー | 全依存関係 |
| Dependabot | リアルタイム | GitHub連携 |

### 脆弱性対応

| 重大度 | 対応期限 | 担当 |
|--------|---------|------|
| Critical | 24時間以内 | セキュリティチーム |
| High | 1週間以内 | 開発チーム |
| Medium | 1ヶ月以内 | 開発チーム |
| Low | 次回更新時 | 開発チーム |

---

## 依存関係追加ガイドライン

### 新規追加時のチェックリスト

- [ ] 目的が明確である
- [ ] 代替手段を検討した
- [ ] ライセンスが許可範囲内
- [ ] セキュリティスキャン合格
- [ ] メンテナンス状況が良好
- [ ] バンドルサイズへの影響を確認
- [ ] ドキュメントが充実している

### 追加承認フロー

```
1. 開発者が依存関係追加を提案
   ↓
2. 技術リードがレビュー
   ↓
3. セキュリティチームが確認（必要時）
   ↓
4. 法務が確認（必要時）
   ↓
5. 承認後、追加
```

---

## 依存関係グラフ

```
project
├── frontend
│   ├── react
│   │   └── react-dom
│   ├── typescript
│   └── @tanstack/react-query
├── backend
│   ├── express
│   ├── prisma
│   │   └── @prisma/client
│   └── zod
└── shared
    └── typescript
```

---

_最終更新日: YYYY-MM-DD_
_更新者: [担当者/AIエージェント名]_
